# 技术假设

## 仓库结构：Monorepo

采用Monorepo结构，在单一仓库中管理前后端代码，利于代码共享和版本控制：

```
mer-demo/
├── backend/              # Go workspace根目录
│   ├── go.work          # Go workspace配置
│   ├── shared/          # 共享领域和基础设施
│   ├── services/        # 微服务模块
│   └── docs/           # 技术文档
├── frontend/           # 前端项目集合
│   ├── admin-panel/    # 租户管理后台
│   ├── merchant-portal/# 商户运营门户  
│   └── customer-app/   # 客户服务应用
└── deployment/         # 部署配置
```

## 服务架构

**微服务架构 + DDD设计**：

- **租户服务**：处理租户管理、认证授权和配置
- **商户服务**：管理商户信息、状态和权限
- **商品服务**：商品目录、库存和定价管理
- **订单服务**：订单处理、核销和状态管理
- **资金权益服务**：资金管理和权益分配追踪
- **报表服务**：数据分析和报表生成

服务间通过事件驱动架构进行通信，使用领域事件实现松耦合。

## 测试要求

**全面测试策略**：

- **单元测试**：覆盖率达到80%以上，重点测试业务逻辑
- **集成测试**：验证服务间交互和数据一致性
- **端到端测试**：模拟用户完整业务流程
- **性能测试**：验证并发处理能力和响应时间
- **安全测试**：多租户数据隔离和权限控制验证

## 其他技术假设和要求

**技术栈选型**：
- **后端**：Go 1.19+ + GoFrame v2 + MySQL 8.0+ + Redis
- **前端**：React 18+ + Amis + TypeScript + Vite
- **基础设施**：Docker + Kubernetes + Prometheus + Grafana

**关键技术决策**：
- 使用JWT进行身份认证和授权
- 采用RBAC权限模型支持多层级权限管理
- 实施CQRS模式优化读写性能
- 使用事件溯源记录关键业务操作
- MySQL分库分表策略支持大规模租户扩展
- 应用层维护数据一致性，不依赖数据库外键约束
- 通过领域服务和聚合根确保业务规则和数据完整性
- 使用乐观锁和分布式事务处理并发控制
